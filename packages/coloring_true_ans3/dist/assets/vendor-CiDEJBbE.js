import{c as oe,P as H}from"./phaser_vendor-D9yEWc94.js";var ye={};var Me;function ze(){return Me||(Me=1,(function(t){(function(){var s=function(){this.init()};s.prototype={init:function(){var e=this||r;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var n=this||r;if(e=parseFloat(e),n.ctx||S(),typeof e<"u"&&e>=0&&e<=1){if(n._volume=e,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(e,r.ctx.currentTime);for(var o=0;o<n._howls.length;o++)if(!n._howls[o]._webAudio)for(var u=n._howls[o]._getSoundIds(),p=0;p<u.length;p++){var _=n._howls[o]._soundById(u[p]);_&&_._node&&(_._node.volume=_._volume*e)}return n}return n._volume},mute:function(e){var n=this||r;n.ctx||S(),n._muted=e,n.usingWebAudio&&n.masterGain.gain.setValueAtTime(e?0:n._volume,r.ctx.currentTime);for(var o=0;o<n._howls.length;o++)if(!n._howls[o]._webAudio)for(var u=n._howls[o]._getSoundIds(),p=0;p<u.length;p++){var _=n._howls[o]._soundById(u[p]);_&&_._node&&(_._node.muted=e?!0:_._muted)}return n},stop:function(){for(var e=this||r,n=0;n<e._howls.length;n++)e._howls[n].stop();return e},unload:function(){for(var e=this||r,n=e._howls.length-1;n>=0;n--)e._howls[n].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,S()),e},codecs:function(e){return(this||r)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||r;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var n=new Audio;typeof n.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var n=new Audio;n.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||r,n=null;try{n=typeof Audio<"u"?new Audio:null}catch{return e}if(!n||typeof n.canPlayType!="function")return e;var o=n.canPlayType("audio/mpeg;").replace(/^no$/,""),u=e._navigator?e._navigator.userAgent:"",p=u.match(/OPR\/(\d+)/g),_=p&&parseInt(p[0].split("/")[1],10)<33,d=u.indexOf("Safari")!==-1&&u.indexOf("Chrome")===-1,v=u.match(/Version\/(.*?) /),T=d&&v&&parseInt(v[1],10)<15;return e._codecs={mp3:!!(!_&&(o||n.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!o,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(n.canPlayType('audio/wav; codecs="1"')||n.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(n.canPlayType("audio/x-m4b;")||n.canPlayType("audio/m4b;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!T&&n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!T&&n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||r;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var n=function(o){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var u=new Audio;u._unlocked=!0,e._releaseHtml5Audio(u)}catch{e.noAudio=!0;break}for(var p=0;p<e._howls.length;p++)if(!e._howls[p]._webAudio)for(var _=e._howls[p]._getSoundIds(),d=0;d<_.length;d++){var v=e._howls[p]._soundById(_[d]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}e._autoResume();var T=e.ctx.createBufferSource();T.buffer=e._scratchBuffer,T.connect(e.ctx.destination),typeof T.start>"u"?T.noteOn(0):T.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),T.onended=function(){T.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",n,!0),document.removeEventListener("touchend",n,!0),document.removeEventListener("click",n,!0),document.removeEventListener("keydown",n,!0);for(var R=0;R<e._howls.length;R++)e._howls[R]._emit("unlock")}};return document.addEventListener("touchstart",n,!0),document.addEventListener("touchend",n,!0),document.addEventListener("click",n,!0),document.addEventListener("keydown",n,!0),e}},_obtainHtml5Audio:function(){var e=this||r;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var n=new Audio().play();return n&&typeof Promise<"u"&&(n instanceof Promise||typeof n.then=="function")&&n.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var n=this||r;return e._unlocked&&n._html5AudioPool.push(e),n},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!r.usingWebAudio)){for(var n=0;n<e._howls.length;n++)if(e._howls[n]._webAudio){for(var o=0;o<e._howls[n]._sounds.length;o++)if(!e._howls[n]._sounds[o]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var u=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(u,u)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!r.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var r=new s,a=function(e){var n=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}n.init(e)};a.prototype={init:function(e){var n=this;return r.ctx||S(),n._autoplay=e.autoplay||!1,n._format=typeof e.format!="string"?e.format:[e.format],n._html5=e.html5||!1,n._muted=e.mute||!1,n._loop=e.loop||!1,n._pool=e.pool||5,n._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,n._rate=e.rate||1,n._sprite=e.sprite||{},n._src=typeof e.src!="string"?e.src:[e.src],n._volume=e.volume!==void 0?e.volume:1,n._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=e.onend?[{fn:e.onend}]:[],n._onfade=e.onfade?[{fn:e.onfade}]:[],n._onload=e.onload?[{fn:e.onload}]:[],n._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],n._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],n._onpause=e.onpause?[{fn:e.onpause}]:[],n._onplay=e.onplay?[{fn:e.onplay}]:[],n._onstop=e.onstop?[{fn:e.onstop}]:[],n._onmute=e.onmute?[{fn:e.onmute}]:[],n._onvolume=e.onvolume?[{fn:e.onvolume}]:[],n._onrate=e.onrate?[{fn:e.onrate}]:[],n._onseek=e.onseek?[{fn:e.onseek}]:[],n._onunlock=e.onunlock?[{fn:e.onunlock}]:[],n._onresume=[],n._webAudio=r.usingWebAudio&&!n._html5,typeof r.ctx<"u"&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&n._preload!=="none"&&n.load(),n},load:function(){var e=this,n=null;if(r.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var o=0;o<e._src.length;o++){var u,p;if(e._format&&e._format[o])u=e._format[o];else{if(p=e._src[o],typeof p!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(p),u||(u=/\.([^.]+)$/.exec(p.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&r.codecs(u)){n=e._src[o];break}}if(!n){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=n,e._state="loading",window.location.protocol==="https:"&&n.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new i(e),e._webAudio&&f(e),e},play:function(e,n){var o=this,u=null;if(typeof e=="number")u=e,e=null;else{if(typeof e=="string"&&o._state==="loaded"&&!o._sprite[e])return null;if(typeof e>"u"&&(e="__default",!o._playLock)){for(var p=0,_=0;_<o._sounds.length;_++)o._sounds[_]._paused&&!o._sounds[_]._ended&&(p++,u=o._sounds[_]._id);p===1?e=null:u=null}}var d=u?o._soundById(u):o._inactiveSound();if(!d)return null;if(u&&!e&&(e=d._sprite||"__default"),o._state!=="loaded"){d._sprite=e,d._ended=!1;var v=d._id;return o._queue.push({event:"play",action:function(){o.play(v)}}),v}if(u&&!d._paused)return n||o._loadQueue("play"),d._id;o._webAudio&&r._autoResume();var T=Math.max(0,d._seek>0?d._seek:o._sprite[e][0]/1e3),R=Math.max(0,(o._sprite[e][0]+o._sprite[e][1])/1e3-T),B=R*1e3/Math.abs(d._rate),G=o._sprite[e][0]/1e3,K=(o._sprite[e][0]+o._sprite[e][1])/1e3;d._sprite=e,d._ended=!1;var J=function(){d._paused=!1,d._seek=T,d._start=G,d._stop=K,d._loop=!!(d._loop||o._sprite[e][2])};if(T>=K){o._ended(d);return}var M=d._node;if(o._webAudio){var Y=function(){o._playLock=!1,J(),o._refreshBuffer(d);var j=d._muted||o._muted?0:d._volume;M.gain.setValueAtTime(j,r.ctx.currentTime),d._playStart=r.ctx.currentTime,typeof M.bufferSource.start>"u"?d._loop?M.bufferSource.noteGrainOn(0,T,86400):M.bufferSource.noteGrainOn(0,T,R):d._loop?M.bufferSource.start(0,T,86400):M.bufferSource.start(0,T,R),B!==1/0&&(o._endTimers[d._id]=setTimeout(o._ended.bind(o,d),B)),n||setTimeout(function(){o._emit("play",d._id),o._loadQueue()},0)};r.state==="running"&&r.ctx.state!=="interrupted"?Y():(o._playLock=!0,o.once("resume",Y),o._clearTimer(d._id))}else{var te=function(){M.currentTime=T,M.muted=d._muted||o._muted||r._muted||M.muted,M.volume=d._volume*r.volume(),M.playbackRate=d._rate;try{var j=M.play();if(j&&typeof Promise<"u"&&(j instanceof Promise||typeof j.then=="function")?(o._playLock=!0,J(),j.then(function(){o._playLock=!1,M._unlocked=!0,n?o._loadQueue():o._emit("play",d._id)}).catch(function(){o._playLock=!1,o._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),d._ended=!0,d._paused=!0})):n||(o._playLock=!1,J(),o._emit("play",d._id)),M.playbackRate=d._rate,M.paused){o._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||d._loop?o._endTimers[d._id]=setTimeout(o._ended.bind(o,d),B):(o._endTimers[d._id]=function(){o._ended(d),M.removeEventListener("ended",o._endTimers[d._id],!1)},M.addEventListener("ended",o._endTimers[d._id],!1))}catch(Q){o._emit("playerror",d._id,Q)}};M.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(M.src=o._src,M.load());var W=window&&window.ejecta||!M.readyState&&r._navigator.isCocoonJS;if(M.readyState>=3||W)te();else{o._playLock=!0,o._state="loading";var Z=function(){o._state="loaded",te(),M.removeEventListener(r._canPlayEvent,Z,!1)};M.addEventListener(r._canPlayEvent,Z,!1),o._clearTimer(d._id)}}return d._id},pause:function(e){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"pause",action:function(){n.pause(e)}}),n;for(var o=n._getSoundIds(e),u=0;u<o.length;u++){n._clearTimer(o[u]);var p=n._soundById(o[u]);if(p&&!p._paused&&(p._seek=n.seek(o[u]),p._rateSeek=0,p._paused=!0,n._stopFade(o[u]),p._node))if(n._webAudio){if(!p._node.bufferSource)continue;typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),n._cleanBuffer(p._node)}else(!isNaN(p._node.duration)||p._node.duration===1/0)&&p._node.pause();arguments[1]||n._emit("pause",p?p._id:null)}return n},stop:function(e,n){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"stop",action:function(){o.stop(e)}}),o;for(var u=o._getSoundIds(e),p=0;p<u.length;p++){o._clearTimer(u[p]);var _=o._soundById(u[p]);_&&(_._seek=_._start||0,_._rateSeek=0,_._paused=!0,_._ended=!0,o._stopFade(u[p]),_._node&&(o._webAudio?_._node.bufferSource&&(typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),o._cleanBuffer(_._node)):(!isNaN(_._node.duration)||_._node.duration===1/0)&&(_._node.currentTime=_._start||0,_._node.pause(),_._node.duration===1/0&&o._clearSound(_._node))),n||o._emit("stop",_._id))}return o},mute:function(e,n){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"mute",action:function(){o.mute(e,n)}}),o;if(typeof n>"u")if(typeof e=="boolean")o._muted=e;else return o._muted;for(var u=o._getSoundIds(n),p=0;p<u.length;p++){var _=o._soundById(u[p]);_&&(_._muted=e,_._interval&&o._stopFade(_._id),o._webAudio&&_._node?_._node.gain.setValueAtTime(e?0:_._volume,r.ctx.currentTime):_._node&&(_._node.muted=r._muted?!0:e),o._emit("mute",_._id))}return o},volume:function(){var e=this,n=arguments,o,u;if(n.length===0)return e._volume;if(n.length===1||n.length===2&&typeof n[1]>"u"){var p=e._getSoundIds(),_=p.indexOf(n[0]);_>=0?u=parseInt(n[0],10):o=parseFloat(n[0])}else n.length>=2&&(o=parseFloat(n[0]),u=parseInt(n[1],10));var d;if(typeof o<"u"&&o>=0&&o<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,n)}}),e;typeof u>"u"&&(e._volume=o),u=e._getSoundIds(u);for(var v=0;v<u.length;v++)d=e._soundById(u[v]),d&&(d._volume=o,n[2]||e._stopFade(u[v]),e._webAudio&&d._node&&!d._muted?d._node.gain.setValueAtTime(o,r.ctx.currentTime):d._node&&!d._muted&&(d._node.volume=o*r.volume()),e._emit("volume",d._id))}else return d=u?e._soundById(u):e._sounds[0],d?d._volume:0;return e},fade:function(e,n,o,u){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"fade",action:function(){p.fade(e,n,o,u)}}),p;e=Math.min(Math.max(0,parseFloat(e)),1),n=Math.min(Math.max(0,parseFloat(n)),1),o=parseFloat(o),p.volume(e,u);for(var _=p._getSoundIds(u),d=0;d<_.length;d++){var v=p._soundById(_[d]);if(v){if(u||p._stopFade(_[d]),p._webAudio&&!v._muted){var T=r.ctx.currentTime,R=T+o/1e3;v._volume=e,v._node.gain.setValueAtTime(e,T),v._node.gain.linearRampToValueAtTime(n,R)}p._startFadeInterval(v,e,n,o,_[d],typeof u>"u")}}return p},_startFadeInterval:function(e,n,o,u,p,_){var d=this,v=n,T=o-n,R=Math.abs(T/.01),B=Math.max(4,R>0?u/R:u),G=Date.now();e._fadeTo=o,e._interval=setInterval(function(){var K=(Date.now()-G)/u;G=Date.now(),v+=T*K,v=Math.round(v*100)/100,T<0?v=Math.max(o,v):v=Math.min(o,v),d._webAudio?e._volume=v:d.volume(v,e._id,!0),_&&(d._volume=v),(o<n&&v<=o||o>n&&v>=o)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,d.volume(o,e._id),d._emit("fade",e._id))},B)},_stopFade:function(e){var n=this,o=n._soundById(e);return o&&o._interval&&(n._webAudio&&o._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(o._interval),o._interval=null,n.volume(o._fadeTo,e),o._fadeTo=null,n._emit("fade",e)),n},loop:function(){var e=this,n=arguments,o,u,p;if(n.length===0)return e._loop;if(n.length===1)if(typeof n[0]=="boolean")o=n[0],e._loop=o;else return p=e._soundById(parseInt(n[0],10)),p?p._loop:!1;else n.length===2&&(o=n[0],u=parseInt(n[1],10));for(var _=e._getSoundIds(u),d=0;d<_.length;d++)p=e._soundById(_[d]),p&&(p._loop=o,e._webAudio&&p._node&&p._node.bufferSource&&(p._node.bufferSource.loop=o,o&&(p._node.bufferSource.loopStart=p._start||0,p._node.bufferSource.loopEnd=p._stop,e.playing(_[d])&&(e.pause(_[d],!0),e.play(_[d],!0)))));return e},rate:function(){var e=this,n=arguments,o,u;if(n.length===0)u=e._sounds[0]._id;else if(n.length===1){var p=e._getSoundIds(),_=p.indexOf(n[0]);_>=0?u=parseInt(n[0],10):o=parseFloat(n[0])}else n.length===2&&(o=parseFloat(n[0]),u=parseInt(n[1],10));var d;if(typeof o=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,n)}}),e;typeof u>"u"&&(e._rate=o),u=e._getSoundIds(u);for(var v=0;v<u.length;v++)if(d=e._soundById(u[v]),d){e.playing(u[v])&&(d._rateSeek=e.seek(u[v]),d._playStart=e._webAudio?r.ctx.currentTime:d._playStart),d._rate=o,e._webAudio&&d._node&&d._node.bufferSource?d._node.bufferSource.playbackRate.setValueAtTime(o,r.ctx.currentTime):d._node&&(d._node.playbackRate=o);var T=e.seek(u[v]),R=(e._sprite[d._sprite][0]+e._sprite[d._sprite][1])/1e3-T,B=R*1e3/Math.abs(d._rate);(e._endTimers[u[v]]||!d._paused)&&(e._clearTimer(u[v]),e._endTimers[u[v]]=setTimeout(e._ended.bind(e,d),B)),e._emit("rate",d._id)}}else return d=e._soundById(u),d?d._rate:e._rate;return e},seek:function(){var e=this,n=arguments,o,u;if(n.length===0)e._sounds.length&&(u=e._sounds[0]._id);else if(n.length===1){var p=e._getSoundIds(),_=p.indexOf(n[0]);_>=0?u=parseInt(n[0],10):e._sounds.length&&(u=e._sounds[0]._id,o=parseFloat(n[0]))}else n.length===2&&(o=parseFloat(n[0]),u=parseInt(n[1],10));if(typeof u>"u")return 0;if(typeof o=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,n)}}),e;var d=e._soundById(u);if(d)if(typeof o=="number"&&o>=0){var v=e.playing(u);v&&e.pause(u,!0),d._seek=o,d._ended=!1,e._clearTimer(u),!e._webAudio&&d._node&&!isNaN(d._node.duration)&&(d._node.currentTime=o);var T=function(){v&&e.play(u,!0),e._emit("seek",u)};if(v&&!e._webAudio){var R=function(){e._playLock?setTimeout(R,0):T()};setTimeout(R,0)}else T()}else if(e._webAudio){var B=e.playing(u)?r.ctx.currentTime-d._playStart:0,G=d._rateSeek?d._rateSeek-d._seek:0;return d._seek+(G+B*Math.abs(d._rate))}else return d._node.currentTime;return e},playing:function(e){var n=this;if(typeof e=="number"){var o=n._soundById(e);return o?!o._paused:!1}for(var u=0;u<n._sounds.length;u++)if(!n._sounds[u]._paused)return!0;return!1},duration:function(e){var n=this,o=n._duration,u=n._soundById(e);return u&&(o=n._sprite[u._sprite][1]/1e3),o},state:function(){return this._state},unload:function(){for(var e=this,n=e._sounds,o=0;o<n.length;o++)n[o]._paused||e.stop(n[o]._id),e._webAudio||(e._clearSound(n[o]._node),n[o]._node.removeEventListener("error",n[o]._errorFn,!1),n[o]._node.removeEventListener(r._canPlayEvent,n[o]._loadFn,!1),n[o]._node.removeEventListener("ended",n[o]._endFn,!1),r._releaseHtml5Audio(n[o]._node)),delete n[o]._node,e._clearTimer(n[o]._id);var u=r._howls.indexOf(e);u>=0&&r._howls.splice(u,1);var p=!0;for(o=0;o<r._howls.length;o++)if(r._howls[o]._src===e._src||e._src.indexOf(r._howls[o]._src)>=0){p=!1;break}return c&&p&&delete c[e._src],r.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,n,o,u){var p=this,_=p["_on"+e];return typeof n=="function"&&_.push(u?{id:o,fn:n,once:u}:{id:o,fn:n}),p},off:function(e,n,o){var u=this,p=u["_on"+e],_=0;if(typeof n=="number"&&(o=n,n=null),n||o)for(_=0;_<p.length;_++){var d=o===p[_].id;if(n===p[_].fn&&d||!n&&d){p.splice(_,1);break}}else if(e)u["_on"+e]=[];else{var v=Object.keys(u);for(_=0;_<v.length;_++)v[_].indexOf("_on")===0&&Array.isArray(u[v[_]])&&(u[v[_]]=[])}return u},once:function(e,n,o){var u=this;return u.on(e,n,o,1),u},_emit:function(e,n,o){for(var u=this,p=u["_on"+e],_=p.length-1;_>=0;_--)(!p[_].id||p[_].id===n||e==="load")&&(setTimeout((function(d){d.call(this,n,o)}).bind(u,p[_].fn),0),p[_].once&&u.off(e,p[_].fn,p[_].id));return u._loadQueue(e),u},_loadQueue:function(e){var n=this;if(n._queue.length>0){var o=n._queue[0];o.event===e&&(n._queue.shift(),n._loadQueue()),e||o.action()}return n},_ended:function(e){var n=this,o=e._sprite;if(!n._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(n._ended.bind(n,e),100),n;var u=!!(e._loop||n._sprite[o][2]);if(n._emit("end",e._id),!n._webAudio&&u&&n.stop(e._id,!0).play(e._id),n._webAudio&&u){n._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=r.ctx.currentTime;var p=(e._stop-e._start)*1e3/Math.abs(e._rate);n._endTimers[e._id]=setTimeout(n._ended.bind(n,e),p)}return n._webAudio&&!u&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,n._clearTimer(e._id),n._cleanBuffer(e._node),r._autoSuspend()),!n._webAudio&&!u&&n.stop(e._id,!0),n},_clearTimer:function(e){var n=this;if(n._endTimers[e]){if(typeof n._endTimers[e]!="function")clearTimeout(n._endTimers[e]);else{var o=n._soundById(e);o&&o._node&&o._node.removeEventListener("ended",n._endTimers[e],!1)}delete n._endTimers[e]}return n},_soundById:function(e){for(var n=this,o=0;o<n._sounds.length;o++)if(e===n._sounds[o]._id)return n._sounds[o];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new i(e)},_drain:function(){var e=this,n=e._pool,o=0,u=0;if(!(e._sounds.length<n)){for(u=0;u<e._sounds.length;u++)e._sounds[u]._ended&&o++;for(u=e._sounds.length-1;u>=0;u--){if(o<=n)return;e._sounds[u]._ended&&(e._webAudio&&e._sounds[u]._node&&e._sounds[u]._node.disconnect(0),e._sounds.splice(u,1),o--)}}},_getSoundIds:function(e){var n=this;if(typeof e>"u"){for(var o=[],u=0;u<n._sounds.length;u++)o.push(n._sounds[u]._id);return o}else return[e]},_refreshBuffer:function(e){var n=this;return e._node.bufferSource=r.ctx.createBufferSource(),e._node.bufferSource.buffer=c[n._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,r.ctx.currentTime),n},_cleanBuffer:function(e){var n=this,o=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return n;if(r._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),o))try{e.bufferSource.buffer=r._scratchBuffer}catch{}return e.bufferSource=null,n},_clearSound:function(e){var n=/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent);n||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(e){this._parent=e,this.init()};i.prototype={init:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._rate=n._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++r._counter,n._sounds.push(e),e.create(),e},create:function(){var e=this,n=e._parent,o=r._muted||e._muted||e._parent._muted?0:e._volume;return n._webAudio?(e._node=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),e._node.gain.setValueAtTime(o,r.ctx.currentTime),e._node.paused=!0,e._node.connect(r.masterGain)):r.noAudio||(e._node=r._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(r._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=n._src,e._node.preload=n._preload===!0?"auto":n._preload,e._node.volume=o*r.volume(),e._node.load()),e},reset:function(){var e=this,n=e._parent;return e._muted=n._muted,e._loop=n._loop,e._volume=n._volume,e._rate=n._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++r._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,n=e._parent;n._duration=Math.ceil(e._node.duration*10)/10,Object.keys(n._sprite).length===0&&(n._sprite={__default:[0,n._duration*1e3]}),n._state!=="loaded"&&(n._state="loaded",n._emit("load"),n._loadQueue()),e._node.removeEventListener(r._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,n=e._parent;n._duration===1/0&&(n._duration=Math.ceil(e._node.duration*10)/10,n._sprite.__default[1]===1/0&&(n._sprite.__default[1]=n._duration*1e3),n._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var c={},f=function(e){var n=e._src;if(c[n]){e._duration=c[n].duration,m(e);return}if(/^data:[^;]+;base64,/.test(n)){for(var o=atob(n.split(",")[1]),u=new Uint8Array(o.length),p=0;p<o.length;++p)u[p]=o.charCodeAt(p);h(u.buffer,e)}else{var _=new XMLHttpRequest;_.open(e._xhr.method,n,!0),_.withCredentials=e._xhr.withCredentials,_.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(d){_.setRequestHeader(d,e._xhr.headers[d])}),_.onload=function(){var d=(_.status+"")[0];if(d!=="0"&&d!=="2"&&d!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");return}h(_.response,e)},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete c[n],e.load())},y(_)}},y=function(e){try{e.send()}catch{e.onerror()}},h=function(e,n){var o=function(){n._emit("loaderror",null,"Decoding audio data failed.")},u=function(p){p&&n._sounds.length>0?(c[n._src]=p,m(n,p)):o()};typeof Promise<"u"&&r.ctx.decodeAudioData.length===1?r.ctx.decodeAudioData(e).then(u).catch(o):r.ctx.decodeAudioData(e,u,o)},m=function(e,n){n&&!e._duration&&(e._duration=n.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},S=function(){if(r.usingWebAudio){try{typeof AudioContext<"u"?r.ctx=new AudioContext:typeof webkitAudioContext<"u"?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch{r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),n=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=n?parseInt(n[1],10):null;if(e&&o&&o<9){var u=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!u&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=typeof r.ctx.createGain>"u"?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};t.Howler=r,t.Howl=a,typeof oe<"u"?(oe.HowlerGlobal=s,oe.Howler=r,oe.Howl=a,oe.Sound=i):typeof window<"u"&&(window.HowlerGlobal=s,window.Howler=r,window.Howl=a,window.Sound=i)})();(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(r){var a=this;if(!a.ctx||!a.ctx.listener)return a;for(var i=a._howls.length-1;i>=0;i--)a._howls[i].stereo(r);return a},HowlerGlobal.prototype.pos=function(r,a,i){var c=this;if(!c.ctx||!c.ctx.listener)return c;if(a=typeof a!="number"?c._pos[1]:a,i=typeof i!="number"?c._pos[2]:i,typeof r=="number")c._pos=[r,a,i],typeof c.ctx.listener.positionX<"u"?(c.ctx.listener.positionX.setTargetAtTime(c._pos[0],Howler.ctx.currentTime,.1),c.ctx.listener.positionY.setTargetAtTime(c._pos[1],Howler.ctx.currentTime,.1),c.ctx.listener.positionZ.setTargetAtTime(c._pos[2],Howler.ctx.currentTime,.1)):c.ctx.listener.setPosition(c._pos[0],c._pos[1],c._pos[2]);else return c._pos;return c},HowlerGlobal.prototype.orientation=function(r,a,i,c,f,y){var h=this;if(!h.ctx||!h.ctx.listener)return h;var m=h._orientation;if(a=typeof a!="number"?m[1]:a,i=typeof i!="number"?m[2]:i,c=typeof c!="number"?m[3]:c,f=typeof f!="number"?m[4]:f,y=typeof y!="number"?m[5]:y,typeof r=="number")h._orientation=[r,a,i,c,f,y],typeof h.ctx.listener.forwardX<"u"?(h.ctx.listener.forwardX.setTargetAtTime(r,Howler.ctx.currentTime,.1),h.ctx.listener.forwardY.setTargetAtTime(a,Howler.ctx.currentTime,.1),h.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),h.ctx.listener.upX.setTargetAtTime(c,Howler.ctx.currentTime,.1),h.ctx.listener.upY.setTargetAtTime(f,Howler.ctx.currentTime,.1),h.ctx.listener.upZ.setTargetAtTime(y,Howler.ctx.currentTime,.1)):h.ctx.listener.setOrientation(r,a,i,c,f,y);else return m;return h},Howl.prototype.init=(function(r){return function(a){var i=this;return i._orientation=a.orientation||[1,0,0],i._stereo=a.stereo||null,i._pos=a.pos||null,i._pannerAttr={coneInnerAngle:typeof a.coneInnerAngle<"u"?a.coneInnerAngle:360,coneOuterAngle:typeof a.coneOuterAngle<"u"?a.coneOuterAngle:360,coneOuterGain:typeof a.coneOuterGain<"u"?a.coneOuterGain:0,distanceModel:typeof a.distanceModel<"u"?a.distanceModel:"inverse",maxDistance:typeof a.maxDistance<"u"?a.maxDistance:1e4,panningModel:typeof a.panningModel<"u"?a.panningModel:"HRTF",refDistance:typeof a.refDistance<"u"?a.refDistance:1,rolloffFactor:typeof a.rolloffFactor<"u"?a.rolloffFactor:1},i._onstereo=a.onstereo?[{fn:a.onstereo}]:[],i._onpos=a.onpos?[{fn:a.onpos}]:[],i._onorientation=a.onorientation?[{fn:a.onorientation}]:[],r.call(this,a)}})(Howl.prototype.init),Howl.prototype.stereo=function(r,a){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(r,a)}}),i;var c=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof a>"u")if(typeof r=="number")i._stereo=r,i._pos=[r,0,0];else return i._stereo;for(var f=i._getSoundIds(a),y=0;y<f.length;y++){var h=i._soundById(f[y]);if(h)if(typeof r=="number")h._stereo=r,h._pos=[r,0,0],h._node&&(h._pannerAttr.panningModel="equalpower",(!h._panner||!h._panner.pan)&&s(h,c),c==="spatial"?typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):h._panner.setPosition(r,0,0):h._panner.pan.setValueAtTime(r,Howler.ctx.currentTime)),i._emit("stereo",h._id);else return h._stereo}return i},Howl.prototype.pos=function(r,a,i,c){var f=this;if(!f._webAudio)return f;if(f._state!=="loaded")return f._queue.push({event:"pos",action:function(){f.pos(r,a,i,c)}}),f;if(a=typeof a!="number"?0:a,i=typeof i!="number"?-.5:i,typeof c>"u")if(typeof r=="number")f._pos=[r,a,i];else return f._pos;for(var y=f._getSoundIds(c),h=0;h<y.length;h++){var m=f._soundById(y[h]);if(m)if(typeof r=="number")m._pos=[r,a,i],m._node&&((!m._panner||m._panner.pan)&&s(m,"spatial"),typeof m._panner.positionX<"u"?(m._panner.positionX.setValueAtTime(r,Howler.ctx.currentTime),m._panner.positionY.setValueAtTime(a,Howler.ctx.currentTime),m._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):m._panner.setPosition(r,a,i)),f._emit("pos",m._id);else return m._pos}return f},Howl.prototype.orientation=function(r,a,i,c){var f=this;if(!f._webAudio)return f;if(f._state!=="loaded")return f._queue.push({event:"orientation",action:function(){f.orientation(r,a,i,c)}}),f;if(a=typeof a!="number"?f._orientation[1]:a,i=typeof i!="number"?f._orientation[2]:i,typeof c>"u")if(typeof r=="number")f._orientation=[r,a,i];else return f._orientation;for(var y=f._getSoundIds(c),h=0;h<y.length;h++){var m=f._soundById(y[h]);if(m)if(typeof r=="number")m._orientation=[r,a,i],m._node&&(m._panner||(m._pos||(m._pos=f._pos||[0,0,-.5]),s(m,"spatial")),typeof m._panner.orientationX<"u"?(m._panner.orientationX.setValueAtTime(r,Howler.ctx.currentTime),m._panner.orientationY.setValueAtTime(a,Howler.ctx.currentTime),m._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):m._panner.setOrientation(r,a,i)),f._emit("orientation",m._id);else return m._orientation}return f},Howl.prototype.pannerAttr=function(){var r=this,a=arguments,i,c,f;if(!r._webAudio)return r;if(a.length===0)return r._pannerAttr;if(a.length===1)if(typeof a[0]=="object")i=a[0],typeof c>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),r._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:r._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:r._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:r._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:r._panningModel});else return f=r._soundById(parseInt(a[0],10)),f?f._pannerAttr:r._pannerAttr;else a.length===2&&(i=a[0],c=parseInt(a[1],10));for(var y=r._getSoundIds(c),h=0;h<y.length;h++)if(f=r._soundById(y[h]),f){var m=f._pannerAttr;m={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:m.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:m.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:m.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:m.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:m.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:m.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:m.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:m.panningModel};var S=f._panner;S||(f._pos||(f._pos=r._pos||[0,0,-.5]),s(f,"spatial"),S=f._panner),S.coneInnerAngle=m.coneInnerAngle,S.coneOuterAngle=m.coneOuterAngle,S.coneOuterGain=m.coneOuterGain,S.distanceModel=m.distanceModel,S.maxDistance=m.maxDistance,S.refDistance=m.refDistance,S.rolloffFactor=m.rolloffFactor,S.panningModel=m.panningModel}return r},Sound.prototype.init=(function(r){return function(){var a=this,i=a._parent;a._orientation=i._orientation,a._stereo=i._stereo,a._pos=i._pos,a._pannerAttr=i._pannerAttr,r.call(this),a._stereo?i.stereo(a._stereo):a._pos&&i.pos(a._pos[0],a._pos[1],a._pos[2],a._id)}})(Sound.prototype.init),Sound.prototype.reset=(function(r){return function(){var a=this,i=a._parent;return a._orientation=i._orientation,a._stereo=i._stereo,a._pos=i._pos,a._pannerAttr=i._pannerAttr,a._stereo?i.stereo(a._stereo):a._pos?i.pos(a._pos[0],a._pos[1],a._pos[2],a._id):a._panner&&(a._panner.disconnect(0),a._panner=void 0,i._refreshBuffer(a)),r.call(this)}})(Sound.prototype.reset);var s=function(r,a){a=a||"spatial",a==="spatial"?(r._panner=Howler.ctx.createPanner(),r._panner.coneInnerAngle=r._pannerAttr.coneInnerAngle,r._panner.coneOuterAngle=r._pannerAttr.coneOuterAngle,r._panner.coneOuterGain=r._pannerAttr.coneOuterGain,r._panner.distanceModel=r._pannerAttr.distanceModel,r._panner.maxDistance=r._pannerAttr.maxDistance,r._panner.refDistance=r._pannerAttr.refDistance,r._panner.rolloffFactor=r._pannerAttr.rolloffFactor,r._panner.panningModel=r._pannerAttr.panningModel,typeof r._panner.positionX<"u"?(r._panner.positionX.setValueAtTime(r._pos[0],Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(r._pos[1],Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(r._pos[2],Howler.ctx.currentTime)):r._panner.setPosition(r._pos[0],r._pos[1],r._pos[2]),typeof r._panner.orientationX<"u"?(r._panner.orientationX.setValueAtTime(r._orientation[0],Howler.ctx.currentTime),r._panner.orientationY.setValueAtTime(r._orientation[1],Howler.ctx.currentTime),r._panner.orientationZ.setValueAtTime(r._orientation[2],Howler.ctx.currentTime)):r._panner.setOrientation(r._orientation[0],r._orientation[1],r._orientation[2])):(r._panner=Howler.ctx.createStereoPanner(),r._panner.pan.setValueAtTime(r._stereo,Howler.ctx.currentTime)),r._panner.connect(r._node),r._paused||r._parent.pause(r._id,!0).play(r._id,!0)}})()})(ye)),ye}var se=ze(),ge={exports:{}},k={};var Ce;function et(){if(Ce)return k;Ce=1;var t=Symbol.for("react.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),f=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),e=Symbol.iterator;function n(l){return l===null||typeof l!="object"?null:(l=e&&l[e]||l["@@iterator"],typeof l=="function"?l:null)}var o={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u=Object.assign,p={};function _(l,g,A){this.props=l,this.context=g,this.refs=p,this.updater=A||o}_.prototype.isReactComponent={},_.prototype.setState=function(l,g){if(typeof l!="object"&&typeof l!="function"&&l!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,l,g,"setState")},_.prototype.forceUpdate=function(l){this.updater.enqueueForceUpdate(this,l,"forceUpdate")};function d(){}d.prototype=_.prototype;function v(l,g,A){this.props=l,this.context=g,this.refs=p,this.updater=A||o}var T=v.prototype=new d;T.constructor=v,u(T,_.prototype),T.isPureReactComponent=!0;var R=Array.isArray,B=Object.prototype.hasOwnProperty,G={current:null},K={key:!0,ref:!0,__self:!0,__source:!0};function J(l,g,A){var P,O={},D=null,F=null;if(g!=null)for(P in g.ref!==void 0&&(F=g.ref),g.key!==void 0&&(D=""+g.key),g)B.call(g,P)&&!K.hasOwnProperty(P)&&(O[P]=g[P]);var V=arguments.length-2;if(V===1)O.children=A;else if(1<V){for(var L=Array(V),q=0;q<V;q++)L[q]=arguments[q+2];O.children=L}if(l&&l.defaultProps)for(P in V=l.defaultProps,V)O[P]===void 0&&(O[P]=V[P]);return{$$typeof:t,type:l,key:D,ref:F,props:O,_owner:G.current}}function M(l,g){return{$$typeof:t,type:l.type,key:g,ref:l.ref,props:l.props,_owner:l._owner}}function Y(l){return typeof l=="object"&&l!==null&&l.$$typeof===t}function te(l){var g={"=":"=0",":":"=2"};return"$"+l.replace(/[=:]/g,function(A){return g[A]})}var W=/\/+/g;function Z(l,g){return typeof l=="object"&&l!==null&&l.key!=null?te(""+l.key):g.toString(36)}function j(l,g,A,P,O){var D=typeof l;(D==="undefined"||D==="boolean")&&(l=null);var F=!1;if(l===null)F=!0;else switch(D){case"string":case"number":F=!0;break;case"object":switch(l.$$typeof){case t:case s:F=!0}}if(F)return F=l,O=O(F),l=P===""?"."+Z(F,0):P,R(O)?(A="",l!=null&&(A=l.replace(W,"$&/")+"/"),j(O,g,A,"",function(q){return q})):O!=null&&(Y(O)&&(O=M(O,A+(!O.key||F&&F.key===O.key?"":(""+O.key).replace(W,"$&/")+"/")+l)),g.push(O)),1;if(F=0,P=P===""?".":P+":",R(l))for(var V=0;V<l.length;V++){D=l[V];var L=P+Z(D,V);F+=j(D,g,A,L,O)}else if(L=n(l),typeof L=="function")for(l=L.call(l),V=0;!(D=l.next()).done;)D=D.value,L=P+Z(D,V++),F+=j(D,g,A,L,O);else if(D==="object")throw g=String(l),Error("Objects are not valid as a React child (found: "+(g==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":g)+"). If you meant to render a collection of children, use an array instead.");return F}function Q(l,g,A){if(l==null)return l;var P=[],O=0;return j(l,P,"","",function(D){return g.call(A,D,O++)}),P}function ce(l){if(l._status===-1){var g=l._result;g=g(),g.then(function(A){(l._status===0||l._status===-1)&&(l._status=1,l._result=A)},function(A){(l._status===0||l._status===-1)&&(l._status=2,l._result=A)}),l._status===-1&&(l._status=0,l._result=g)}if(l._status===1)return l._result.default;throw l._result}var N={current:null},w={transition:null},I={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:w,ReactCurrentOwner:G};function E(){throw Error("act(...) is not supported in production builds of React.")}return k.Children={map:Q,forEach:function(l,g,A){Q(l,function(){g.apply(this,arguments)},A)},count:function(l){var g=0;return Q(l,function(){g++}),g},toArray:function(l){return Q(l,function(g){return g})||[]},only:function(l){if(!Y(l))throw Error("React.Children.only expected to receive a single React element child.");return l}},k.Component=_,k.Fragment=r,k.Profiler=i,k.PureComponent=v,k.StrictMode=a,k.Suspense=h,k.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,k.act=E,k.cloneElement=function(l,g,A){if(l==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+l+".");var P=u({},l.props),O=l.key,D=l.ref,F=l._owner;if(g!=null){if(g.ref!==void 0&&(D=g.ref,F=G.current),g.key!==void 0&&(O=""+g.key),l.type&&l.type.defaultProps)var V=l.type.defaultProps;for(L in g)B.call(g,L)&&!K.hasOwnProperty(L)&&(P[L]=g[L]===void 0&&V!==void 0?V[L]:g[L])}var L=arguments.length-2;if(L===1)P.children=A;else if(1<L){V=Array(L);for(var q=0;q<L;q++)V[q]=arguments[q+2];P.children=V}return{$$typeof:t,type:l.type,key:O,ref:D,props:P,_owner:F}},k.createContext=function(l){return l={$$typeof:f,_currentValue:l,_currentValue2:l,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},l.Provider={$$typeof:c,_context:l},l.Consumer=l},k.createElement=J,k.createFactory=function(l){var g=J.bind(null,l);return g.type=l,g},k.createRef=function(){return{current:null}},k.forwardRef=function(l){return{$$typeof:y,render:l}},k.isValidElement=Y,k.lazy=function(l){return{$$typeof:S,_payload:{_status:-1,_result:l},_init:ce}},k.memo=function(l,g){return{$$typeof:m,type:l,compare:g===void 0?null:g}},k.startTransition=function(l){var g=w.transition;w.transition={};try{l()}finally{w.transition=g}},k.unstable_act=E,k.useCallback=function(l,g){return N.current.useCallback(l,g)},k.useContext=function(l){return N.current.useContext(l)},k.useDebugValue=function(){},k.useDeferredValue=function(l){return N.current.useDeferredValue(l)},k.useEffect=function(l,g){return N.current.useEffect(l,g)},k.useId=function(){return N.current.useId()},k.useImperativeHandle=function(l,g,A){return N.current.useImperativeHandle(l,g,A)},k.useInsertionEffect=function(l,g){return N.current.useInsertionEffect(l,g)},k.useLayoutEffect=function(l,g){return N.current.useLayoutEffect(l,g)},k.useMemo=function(l,g){return N.current.useMemo(l,g)},k.useReducer=function(l,g,A){return N.current.useReducer(l,g,A)},k.useRef=function(l){return N.current.useRef(l)},k.useState=function(l){return N.current.useState(l)},k.useSyncExternalStore=function(l,g,A){return N.current.useSyncExternalStore(l,g,A)},k.useTransition=function(){return N.current.useTransition()},k.version="18.3.1",k}var Re;function He(){return Re||(Re=1,ge.exports=et()),ge.exports}He();var ve={exports:{}},ie={};var Oe;function tt(){if(Oe)return ie;Oe=1;var t=He(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function f(y,h,m){var S,e={},n=null,o=null;m!==void 0&&(n=""+m),h.key!==void 0&&(n=""+h.key),h.ref!==void 0&&(o=h.ref);for(S in h)a.call(h,S)&&!c.hasOwnProperty(S)&&(e[S]=h[S]);if(y&&y.defaultProps)for(S in h=y.defaultProps,h)e[S]===void 0&&(e[S]=h[S]);return{$$typeof:s,type:y,key:n,ref:o,props:e,_owner:i.current}}return ie.Fragment=r,ie.jsx=f,ie.jsxs=f,ie}var Pe;function nt(){return Pe||(Pe=1,ve.exports=tt()),ve.exports}nt();var Ne=Object.defineProperty,rt=(t,s,r)=>s in t?Ne(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,he=(t,s)=>{for(var r in s)Ne(t,r,{get:s[r],enumerable:!0})},x=(t,s,r)=>rt(t,typeof s!="symbol"?s+"":s,r);(class extends H.Plugins.BasePlugin{constructor(t){super(t),x(this,"bridge")}init(t){this.bridge=t,console.log("[IrukaSDK] ðŸ”Œ Phaser Plugin Attached")}get context(){return this.bridge?this.bridge.context:(console.warn("[IrukaSDK] Accessing context before bridge is ready"),{})}submitResult(t,s=0,r={}){this.bridge.send("EVT:COMPLETE",{score:t,completion:1,details:{stars:s,...r},timestamp:Date.now()})}saveState(t){this.bridge.send("CMD:SAVE_STATE",t)}vibrate(t=200){navigator.vibrate&&navigator.vibrate(t)}submitScore(t,s){console.warn("[IrukaSDK] submitScore() is deprecated, use submitResult() instead"),this.bridge.send("EVT:SCORE_UPDATE",{score:t,delta:s,timestamp:Date.now()})}submitProgress(t,s){console.warn("[IrukaSDK] submitProgress() is deprecated"),this.bridge.send("EVT:PROGRESS",{current:t,total:s,percentage:t/s,timestamp:Date.now()})}completeGame(t){console.warn("[IrukaSDK] completeGame() is deprecated, use submitResult() instead"),this.submitResult(t.score,0,{timeMs:t.timeMs,...t.extras})}async loadState(){return console.warn("[IrukaSDK] loadState() is deprecated"),this.bridge.send("CMD:REQUEST_LOAD"),null}getContext(){return console.warn("[IrukaSDK] getContext() is deprecated, use context property instead"),this.context}track(t,s){console.warn("[IrukaSDK] track() is deprecated"),this.bridge.send("EVT:TELEMETRY",{eventType:t,data:s,timestamp:Date.now()})}});var ot={};he(ot,{addHint:()=>Tt,createGameSdk:()=>vt,finalizeAttempt:()=>Ct,finishQuestionTimer:()=>Ee,getStatsSnapshot:()=>We,prepareSubmitData:()=>Qe,recordCorrect:()=>Et,recordQuestionDuration:()=>At,recordWrong:()=>kt,resetAll:()=>Rt,retryFromStart:()=>Ke,setPassCriteria:()=>It,setTotal:()=>xt,startQuestionTimer:()=>St});function Le(t){return{sdkVersion:t.sdkVersion,source:t.source,sessionId:t.sessionId,gameId:t.gameId,lessonId:t.lessonId,gameVersion:t.gameVersion,type:t.type,payload:t.payload}}function Ge(t){try{return JSON.stringify(t).length}catch{return Number.POSITIVE_INFINITY}}function ne(t){return typeof t=="object"&&t!==null}function st(t){return!(!ne(t)||typeof t.sdkVersion!="string"||t.sdkVersion.length<1||t.source!=="hub"&&t.source!=="game"||typeof t.sessionId!="string"||t.sessionId.length<1||typeof t.gameId!="string"||t.gameId.length<1||typeof t.lessonId!="string"||t.lessonId.length<1||typeof t.type!="string"||t.type.length<1)}function it(t){return t==="INIT"||t==="START"||t==="PAUSE"||t==="RESUME"||t==="RESIZE"||t==="QUIT"||t==="SET_STATE"}function at(t){return!Number.isFinite(t)||t<0?0:t>1?1:t}function C(t){return{ok:!1,error:t}}function z(t){return{ok:!0,value:t}}function ee(t){return typeof t=="number"&&Number.isFinite(t)}function X(t){return typeof t=="string"}function ut(t){return typeof t=="boolean"}function $(t,s){return t[s]}var pe=16*1024;function ct(t){const s=Ge(t);return s>pe?C(`payload_too_large: ${s} bytes > ${pe}`):z(void 0)}function lt(t){if(!ne(t))return C("LaunchContext must be an object");const s=$(t,"sessionId");if(!X(s)||s.length<1)return C("LaunchContext.sessionId must be a non-empty string");const r=$(t,"lessonId");if(!X(r)||r.length<1)return C("LaunchContext.lessonId must be a non-empty string");const a=$(t,"gameId");if(!X(a)||a.length<1)return C("LaunchContext.gameId must be a non-empty string");const i=$(t,"gameVersion");if(!X(i)||i.length<1)return C("LaunchContext.gameVersion must be a non-empty string");const c=$(t,"locale");if(!X(c)||c.length<1)return C("LaunchContext.locale must be a non-empty string");const f=$(t,"sdkVersion");if(f!==void 0&&!X(f))return C("LaunchContext.sdkVersion must be a string");const y=$(t,"playerId");if(y!==void 0&&!X(y))return C("LaunchContext.playerId must be a string");const h=$(t,"launchToken");if(h!==void 0&&!X(h))return C("LaunchContext.launchToken must be a string");const m=$(t,"difficulty");if(m!==void 0&&!X(m))return C("LaunchContext.difficulty must be a string");const S=$(t,"seed");if(S!==void 0&&!ee(S))return C("LaunchContext.seed must be a number");const e=$(t,"profile");if(e!==void 0&&!ne(e))return C("LaunchContext.profile must be an object");const n=$(t,"sizeHint");if(n!==void 0){if(!ne(n))return C("LaunchContext.sizeHint must be an object");const u=$(n,"width"),p=$(n,"height"),_=$(n,"devicePixelRatio");if(!ee(u)||u<=0)return C("LaunchContext.sizeHint.width must be a positive number");if(!ee(p)||p<=0)return C("LaunchContext.sizeHint.height must be a positive number");if(_!==void 0&&(!ee(_)||_<=0||_>8))return C("LaunchContext.sizeHint.devicePixelRatio must be (0..8]")}const o=$(t,"featureFlags");if(o!==void 0){if(!ne(o))return C("LaunchContext.featureFlags must be an object");for(const[u,p]of Object.entries(o))if(!ut(p))return C(`LaunchContext.featureFlags['${u}'] must be boolean`)}return z({sdkVersion:f,playerId:y,sessionId:s,lessonId:r,gameId:a,gameVersion:i,locale:c,difficulty:m,seed:S,launchToken:h,profile:e,sizeHint:n,featureFlags:o})}function dt(t){if(!ne(t))return C("RESIZE.payload must be an object");const s=$(t,"width"),r=$(t,"height"),a=$(t,"dpr");return!ee(s)||s<=0?C("RESIZE.payload.width must be a positive number"):!ee(r)||r<=0?C("RESIZE.payload.height must be a positive number"):!ee(a)||a<=0||a>8?C("RESIZE.payload.dpr must be (0..8]"):z({width:s,height:r,dpr:a})}function ft(t){if(!st(t))return C("Invalid envelope");const s=ct(t);return s.ok?z(t):s}function pt(t){const s=t.type;if(!it(s))return C(`Unknown HubCommand type: ${s}`);switch(s){case"INIT":{const r=lt(t.payload);return r.ok?z({type:"INIT",payload:r.value}):C(`INIT.payload invalid: ${r.error}`)}case"RESIZE":{const r=dt(t.payload);return r.ok?z({type:"RESIZE",payload:r.value}):C(`RESIZE.payload invalid: ${r.error}`)}case"START":case"PAUSE":case"RESUME":case"QUIT":return z({type:s});case"SET_STATE":return z({type:"SET_STATE",payload:t.payload})}}var _t={},xe={};function ht(t){xe={...xe,...t}}function mt(){return{..._t,...xe}}var ae={maxRecords:2e3,maxJsonChars:4e3},de=!1,re=[];function yt(t,s=ae.maxJsonChars){try{const r=JSON.stringify(t,(a,i)=>i instanceof Error?{name:i.name,message:i.message,stack:i.stack}:i);return r.length<=s?JSON.parse(r):{truncated:!0,preview:r.slice(0,s)+"â€¦"}}catch{return{unserializable:!0,preview:String(t)}}}function U(t,s,r){de&&(re.unshift({t:performance.now(),cat:t,name:s,data:r===void 0?void 0:yt(r)}),re.length>ae.maxRecords&&(re.length=ae.maxRecords))}var an={enable(){de=!0},disable(){de=!1},isEnabled(){return de},reset(){re.length=0},getRecords(){return re.map(t=>({...t,data:t.data}))},getSummary(){const t={};for(const s of re){const r=`${s.cat}:${s.name}`;t[r]=(t[r]||0)+1}return t},setConfig(t){typeof t.maxRecords=="number"&&t.maxRecords>0&&(ae.maxRecords=Math.floor(t.maxRecords)),typeof t.maxJsonChars=="number"&&t.maxJsonChars>100&&(ae.maxJsonChars=Math.floor(t.maxJsonChars))}};function we(t){return t.replace(/\/+$/,"")}var Te=typeof window<"u"&&window.__DEV__||typeof location<"u"&&(location.hostname==="localhost"||location.hostname==="127.0.0.1");function gt(t){try{if(typeof document<"u"&&document.referrer)return new URL(document.referrer).origin}catch{}return t}function De(t,s){window.parent.postMessage(t,Te?"*":s)}function vt(t){const s=we(gt(t.hubOrigin)),r=Te?null:new Set((t.allowlistHubOrigins??[s]).map(we));let a=!1,i=null,c,f,y,h,m=0,S=0,e=null,n=null;function o(w,I,E){t.onInvalidMessage?.({reason:w,origin:I,data:E})}function u(w,I){if(a||!i)return;const E=Le({sdkVersion:c,source:"game",sessionId:i,gameId:f,lessonId:y,gameVersion:h,type:w,payload:I}),l=Ge(E);if(U("sdk","sendEvent",{type:w,bytes:l}),l>pe){U("sdk","payloadTooLarge",{type:w,bytes:l,limit:pe});const g=Le({sdkVersion:c,source:"game",sessionId:i,gameId:f,lessonId:y,gameVersion:h,type:"ERROR",payload:{code:"RUNTIME_EXCEPTION",message:`payload_too_large: ${l} bytes`}});De(g,s);return}De(E,s)}const p=10,_=400,d=5e3,v=5;let T=0,R=0;const B=new Map,G=[];function K(w){const I=typeof w=="string"?w:w?String(w):"Unknown error";return I.length>500?I.slice(0,500)+"â€¦":I}function J(w,I=2e3){try{const E=JSON.stringify(w,(l,g)=>g instanceof Error?{name:g.name,message:g.message,stack:g.stack}:g);return E.length<=I?JSON.parse(E):{truncated:!0,preview:E.slice(0,I)+"â€¦"}}catch{return{unserializable:!0,preview:K(w)}}}function M(w,I,E){const l=E??{},g=`${l?.filename??""}:${l?.lineno??""}:${l?.colno??""}`;return`${String(w)}|${I}|${g}`}function Y(w){const I=performance.now();if(T>=p||I-R<_)return!1;const E=B.get(w);return!(E&&I-E<d)}function te(w){const I=performance.now();if(R=I,T+=1,B.set(w,I),B.size>50)for(const[E,l]of B)I-l>d&&B.delete(E)}function W(w,I,E){try{const l=K(I),g=E?J(E):void 0,A=M(w,l,g);if(!i){G.length<v&&G.push({code:w,message:l,detail:g});return}if(!Y(A))return;te(A),u("ERROR",{code:w,message:l,detail:g})}catch{}}function Z(){if(i&&G.length!==0)for(const w of G.splice(0))W(w.code,w.message,w.detail)}function j(w){if(a)return;const I=ft(w.data);if(!I.ok)return;const E=we(w.origin);if(!Te&&r&&!r.has(E)){o("origin_not_allowed",E,w.data);return}if(w.source!==window.parent){o("source_not_parent",E,w.data);return}const l=I.value,g=pt(l);if(!g.ok){o(`invalid_hub_command: ${g.error}`,E,w.data);return}const A=g.value;if(U("hub","recvCommand",{type:A.type}),A.type==="INIT"){if(c=l.sdkVersion,i=l.sessionId,f=l.gameId,y=l.lessonId,h=l.gameVersion,U("hub","init",{sessionId:i}),ht({sdkVersion:c,sessionId:i,gameId:f,lessonId:y,gameVersion:h,hubOrigin:s}),A.payload?.sessionId&&A.payload.sessionId!==i){o("sessionId_mismatch_envelope_vs_payload",E,w.data);return}if(A.payload?.gameId&&A.payload.gameId!==f){o("gameId_mismatch_envelope_vs_payload",E,w.data);return}if(A.payload?.lessonId&&A.payload.lessonId!==y){o("lessonId_mismatch_envelope_vs_payload",E,w.data);return}T=0,R=0,B.clear(),t.onInit?.(A.payload),Z();return}if(!i){o("command_before_init",E,w.data);return}if(l.sessionId!==i){o("sessionId_mismatch",E,w.data);return}switch(A.type){case"START":t.onStart?.();break;case"PAUSE":t.onPause?.();break;case"RESUME":t.onResume?.();break;case"RESIZE":t.onResize?.(A.payload);break;case"QUIT":t.onQuit?.();break;case"SET_STATE":t.onSetState?.(A.payload);break}}window.addEventListener("message",j);const Q=w=>{W("UNHANDLED_REJECTION","Unhandled promise rejection",{reason:w.reason})},ce=w=>{if(w?.target&&!w?.error){const E=w.target;W("RESOURCE_LOAD_ERROR","Resource load error",{tagName:E?.tagName,src:E?.src,href:E?.href});return}W("RUNTIME_EXCEPTION",w.message||"Window error",{filename:w.filename,lineno:w.lineno,colno:w.colno,stack:w.error&&w.error.stack?String(w.error.stack):void 0})};return window.addEventListener("unhandledrejection",Q),window.addEventListener("error",ce,!0),{ready(w){u("READY",w)},loading(w){const I=performance.now();I-m>=1e3&&(m=I,S=0),!(S>=10)&&(S+=1,u("LOADING",{progress:at(w)}))},score(w,I){n={score:w,delta:I},!e&&(e=window.setTimeout(()=>{if(e=null,!n)return;const E=n;n=null,u("SCORE_UPDATE",E)},100))},progress(w){u("PROGRESS",w)},complete(w){u("COMPLETE",w)},error(w){u("ERROR",w)},destroy(){a||(a=!0,e&&window.clearTimeout(e),e=null,n=null,window.removeEventListener("message",j),window.removeEventListener("unhandledrejection",Q),window.removeEventListener("error",ce))},getSessionId(){return i},requestSave(w){u("REQUEST_SAVE",w)},requestLoad(){u("REQUEST_LOAD")}}}function wt(t){return Number.isFinite(t)?Math.max(0,Math.min(1,t)):0}var _e={accuracyThreshold:.6,requireCompletion:!0},b={hintCount:0,retryCount:0,sessionMistakeCount:0,total:0,finalScore:0,bestScore:0,attemptCorrect:0,attemptWrong:0,attempts:[],attemptStartedAtMs:performance.now(),questionDurationsMs:[],currentQuestionStartedAtMs:void 0};function bt(){return b.attempts.length+1}function Ue(){const t=b.attemptCorrect,s=b.attemptWrong,r=t+s;return r<=0?0:t/r}function je(){return b.total<=0?0:wt(b.attemptCorrect/b.total)}function ke(){return{attemptIndex:bt(),correct:b.attemptCorrect,wrong:b.attemptWrong,total:b.total,completion:je(),accuracy:Ue(),finalScore:b.finalScore,startedAtMs:b.attemptStartedAtMs,outcome:b.attempts[b.attempts.length-1]?.outcome,questionDurationsMs:[...b.questionDurationsMs]}}function qe(){return performance.now()}function St(){typeof b.currentQuestionStartedAtMs=="number"&&Ee(),b.currentQuestionStartedAtMs=qe(),U("stats","startQuestionTimer",{ok:!0})}function Ee(){const t=b.currentQuestionStartedAtMs;if(typeof t!="number")return U("stats","finishQuestionTimer",{ok:!1,reason:"not_started"}),null;const s=Math.max(0,qe()-t);return b.questionDurationsMs.push(s),b.currentQuestionStartedAtMs=void 0,U("stats","finishQuestionTimer",{ok:!0,durationMs:s,count:b.questionDurationsMs.length}),s}function At(t){const s=Number.isFinite(t)?Math.max(0,t):0;b.questionDurationsMs.push(s)}function xt(t){b.total=Math.max(0,Math.floor(t)),U("stats","setTotal",{total:b.total})}function Tt(){b.hintCount+=1,U("stats","addHint",{hintCount:b.hintCount})}function kt(){b.attemptWrong+=1,b.sessionMistakeCount+=1,U("stats","recordWrong",{attemptWrong:b.attemptWrong,sessionMistakeCount:b.sessionMistakeCount})}function Et(t){b.attemptCorrect+=1,typeof t?.scoreAbs=="number"&&Number.isFinite(t.scoreAbs)?b.finalScore=t.scoreAbs:typeof t?.scoreDelta=="number"&&Number.isFinite(t.scoreDelta)&&(b.finalScore+=t.scoreDelta),b.finalScore>b.bestScore&&(b.bestScore=b.finalScore),U("stats","recordCorrect",{attemptCorrect:b.attemptCorrect,finalScore:b.finalScore,bestScore:b.bestScore,opts:t})}function Ke(){b.retryCount+=1,b.attemptCorrect=0,b.attemptWrong=0,b.finalScore=0,b.attemptStartedAtMs=performance.now(),b.questionDurationsMs=[],b.currentQuestionStartedAtMs=void 0,U("stats","retryFromStart",{retryCount:b.retryCount})}function It(t){if(typeof t.accuracyThreshold=="number"){const s=Math.max(0,Math.min(1,t.accuracyThreshold));_e.accuracyThreshold=s}typeof t.requireCompletion=="boolean"&&(_e.requireCompletion=t.requireCompletion)}function Mt(){const t=ke(),s=_e.requireCompletion?t.completion>=1:!0,r=t.accuracy>=_e.accuracyThreshold;return s&&r?"pass":"fail"}function Ct(t){typeof b.currentQuestionStartedAtMs=="number"&&Ee();const s=ke();s.endedAtMs=performance.now(),t==="quit"?s.outcome="quit":t==="pass"||t==="fail"?s.outcome=t:s.outcome=Mt(),b.attempts.push(s),U("stats","finalizeAttempt",{outcome:b.attempts[b.attempts.length-1]?.outcome})}function We(){return{hintCount:b.hintCount,retryCount:b.retryCount,sessionMistakeCount:b.sessionMistakeCount,finalScore:b.finalScore,bestScore:b.bestScore,accuracy:Ue(),completion:je(),attemptMistakeCount:b.attemptWrong,attempts:[...b.attempts],currentAttempt:ke()}}function Rt(){b.hintCount=0,b.retryCount=0,b.sessionMistakeCount=0,b.total=0,b.finalScore=0,b.bestScore=0,b.attemptCorrect=0,b.attemptWrong=0,b.attempts=[],b.attemptStartedAtMs=performance.now(),U("stats","resetAll")}function Qe(){const t=We(),s={finalScore:t.finalScore,accuracy:t.accuracy,bestScore:t.bestScore,completion:t.completion,completion_history:t.attempts,hintCount:t.hintCount,mistakeCount:t.sessionMistakeCount,retryCount:t.retryCount,outcome:t.currentAttempt?.outcome};return U("stats","prepareSubmitData",{finalScore:s.finalScore,accuracy:s.accuracy,bestScore:s.bestScore,completion:s.completion,hintCount:s.hintCount,mistakeCount:s.mistakeCount,retryCount:s.retryCount,outcome:s.outcome,attemptsCount:t.attempts.length}),s}var Ot={};he(Ot,{ResultOverlayDom:()=>Je,ScoreTimer:()=>me,ScoreTimerHudDom:()=>Xe,StateClient:()=>Lt,createGameSessionUiRuntime:()=>Pt});var me=class{constructor(){x(this,"state",{running:!1,startAtMs:null,elapsedMs:0,score:0})}start(t=performance.now()){this.state.running||(this.state.running=!0,this.state.startAtMs=t)}pause(t=performance.now()){this.state.running&&(this.state.elapsedMs=this.getElapsedMs(t),this.state.running=!1,this.state.startAtMs=null)}reset(){this.state.running=!1,this.state.startAtMs=null,this.state.elapsedMs=0,this.state.score=0}setScore(t){this.state.score=Math.max(0,Math.floor(t))}addScore(t){this.setScore(this.state.score+t)}getScore(){return this.state.score}getElapsedMs(t=performance.now()){return!this.state.running||this.state.startAtMs==null?this.state.elapsedMs:this.state.elapsedMs+(t-this.state.startAtMs)}snapshot(t=performance.now()){return{score:this.getScore(),elapsedMs:Math.max(0,Math.floor(this.getElapsedMs(t))),running:this.state.running}}static formatMs(t){const s=Math.max(0,Math.floor(t/1e3)),r=Math.floor(s/60),a=s%60,i=String(r).padStart(2,"0"),c=String(a).padStart(2,"0");return`${i}:${c}`}},Xe=class{constructor(t){x(this,"root"),x(this,"scoreEl"),x(this,"timeEl");const s=t?.mount??document.body,r=t?.safeTop??0,a=t?.safeLeft??0,i=t?.zIndex??9999,c=document.createElement("div");c.style.position="fixed",c.style.top=`${r+12}px`,c.style.left=`${a+12}px`,c.style.zIndex=String(i),c.style.display="flex",c.style.gap="10px",c.style.alignItems="center",c.style.padding="10px 12px",c.style.borderRadius="14px",c.style.background="rgba(0,0,0,0.55)",c.style.backdropFilter="blur(6px)",c.style.color="#fff",c.style.fontFamily="system-ui, -apple-system, Segoe UI, Roboto, Arial",c.style.fontSize="14px",c.style.userSelect="none",c.style.pointerEvents="none";const f=document.createElement("span");f.textContent="Score: 0",f.style.fontWeight="700";const y=document.createElement("span");y.textContent="Time: 00:00",y.style.opacity="0.9",c.append(f,y),s.appendChild(c),this.root=c,this.scoreEl=f,this.timeEl=y}update(t){this.scoreEl.textContent=`Score: ${t.score}`,this.timeEl.textContent=`Time: ${me.formatMs(t.elapsedMs)}`}setVisible(t){this.root.style.display=t?"flex":"none"}destroy(){this.root.remove()}},Je=class{constructor(t){x(this,"root"),x(this,"scoreEl"),x(this,"timeEl");const s=t?.mount??document.body,r=t?.zIndex??1e4,a=t?.safeBottom??0,i=document.createElement("div");i.style.position="fixed",i.style.inset="0",i.style.zIndex=String(r),i.style.display="none",i.style.alignItems="center",i.style.justifyContent="center",i.style.background="rgba(0,0,0,0.55)",i.style.backdropFilter="blur(6px)",i.style.color="#fff",i.style.fontFamily="system-ui, -apple-system, Segoe UI, Roboto, Arial";const c=document.createElement("div");c.style.width="min(520px, calc(100% - 32px))",c.style.borderRadius="18px",c.style.background="rgba(10, 16, 30, 0.95)",c.style.border="1px solid rgba(255,255,255,0.12)",c.style.padding="18px",c.style.boxShadow="0 20px 60px rgba(0,0,0,0.35)",c.style.transform=`translateY(${-a/2}px)`;const f=document.createElement("div");f.textContent="Káº¿t quáº£",f.style.fontSize="18px",f.style.fontWeight="800",f.style.marginBottom="12px";const y=document.createElement("div");y.style.fontSize="16px",y.style.fontWeight="700";const h=document.createElement("div");h.style.marginTop="6px",h.style.opacity="0.9";const m=document.createElement("div");m.style.display="flex",m.style.gap="10px",m.style.marginTop="16px";const S=o=>{const u=document.createElement("button");return u.textContent=o,u.style.flex="1",u.style.padding="10px 12px",u.style.borderRadius="12px",u.style.border="0",u.style.cursor="pointer",u.style.fontWeight="700",u},e=S("ChÆ¡i láº¡i");e.style.background="#2b5cff",e.style.color="#fff",e.onclick=()=>t?.onReplay?.();const n=S("ThoÃ¡t");n.style.background="rgba(255,255,255,0.10)",n.style.color="#fff",n.onclick=()=>t?.onExit?.(),m.append(e,n),c.append(f,y,h,m),i.appendChild(c),s.appendChild(i),this.root=i,this.scoreEl=y,this.timeEl=h}show(t){this.scoreEl.textContent=`Score: ${t.score}`,this.timeEl.textContent=`Time: ${me.formatMs(t.elapsedMs)}`,this.root.style.display="flex"}hide(){this.root.style.display="none"}destroy(){this.root.remove()}};function Pt(t){const s=new me,r=new Xe({safeTop:t.safeInsets?.top??0,safeLeft:t.safeInsets?.left??0});let a=!1;const i=new Je({safeBottom:t.safeInsets?.bottom??0,onReplay:()=>t.onReplay?.(),onExit:()=>t.onExit?.()});let c=null;const f=()=>{const u=s.snapshot();r.update(u),c=requestAnimationFrame(f)};return{timer:s,hud:r,overlay:i,start:()=>{s.start(),c==null&&(c=requestAnimationFrame(f))},pause:()=>s.pause(),resume:()=>s.start(),setScore:(u,p)=>{s.setScore(u),t.sdk.score(u,p)},addScore:u=>{s.addScore(u),t.sdk.score(s.getScore(),u)},finish:u=>{if(a)return;a=!0;const p=s.snapshot();i.show(p),t.sdk.complete({score:p.score,timeMs:p.elapsedMs,extras:u})},destroy:()=>{c!=null&&cancelAnimationFrame(c),c=null,r.destroy(),i.destroy()}}}var Lt=class{constructor(t){x(this,"sdk"),x(this,"pendingLoad",null),this.sdk=t}save(t){this.sdk.requestSave(t)}load(){return this.pendingLoad?Promise.reject(new Error("LOAD_ALREADY_PENDING")):new Promise(t=>{this.pendingLoad=t,this.sdk.requestLoad()})}handleSetState(t){this.pendingLoad&&(this.pendingLoad(t),this.pendingLoad=null)}},Dt={};he(Dt,{AssetManager:()=>Ft,HowlerAudioManager:()=>qt,ScaleManager:()=>Ye,createEndGameScene:()=>Xt,createScaleManager:()=>Vt});var Ye=class{constructor(t,s){x(this,"scene"),x(this,"opts"),x(this,"graphics"),x(this,"lastSnap"),this.scene=t,this.opts={design:s.design,maxDpr:s.maxDpr??2,safeAreaMode:s.safeAreaMode??"css-vars",debug:s.debug??!1,onChange:s.onChange},this.opts.debug&&(this.graphics=t.add.graphics().setDepth(999999))}initFromWindow(){const t=window.innerWidth,s=window.innerHeight,r=window.devicePixelRatio||1;this.applyResize({width:t,height:s,dpr:r})}applyResize(t){const s=Ve(t.dpr??window.devicePixelRatio??1,this.opts.maxDpr),r=this.scene.game;r.renderer&&"resolution"in r.renderer&&(r.renderer.resolution=s),this.scene.scale.resize(t.width,t.height),this.scene.scale.refresh();const a=this.opts.safeAreaMode==="css-vars"?Fe():Be(),i=$e({container:{width:t.width,height:t.height,dpr:s},design:this.opts.design,safeArea:a});this.applyCameraFit(i),(!this.lastSnap||!Bt(this.lastSnap,i))&&(this.lastSnap=i,this.opts.debug&&this.drawDebug(i),this.opts.onChange?.(i),this.scene.events.emit("scale:snapshot",i))}getSnapshot(){return this.lastSnap?this.lastSnap:$e({container:{width:this.scene.scale.width,height:this.scene.scale.height,dpr:Ve(window.devicePixelRatio||1,this.opts.maxDpr)},design:this.opts.design,safeArea:this.opts.safeAreaMode==="css-vars"?Fe():Be()})}getViewport(){return this.getSnapshot().viewport}getSafeArea(){return this.getSnapshot().safeArea}applyCameraFit(t){const s=this.scene.cameras.main;s.setViewport(t.viewport.x,t.viewport.y,t.viewport.width,t.viewport.height),s.setBounds(0,0,t.design.width,t.design.height),s.setZoom(t.scale),s.centerOn(t.design.width/2,t.design.height/2)}drawDebug(t){if(!this.graphics)return;const s=this.graphics;s.clear();const r=t.safeArea.left,a=t.safeArea.top,i=t.container.width-t.safeArea.left-t.safeArea.right,c=t.container.height-t.safeArea.top-t.safeArea.bottom;s.lineStyle(2,65280,1),s.strokeRect(r,a,i,c),s.lineStyle(2,16711935,1),s.strokeRect(t.viewport.x,t.viewport.y,t.viewport.width,t.viewport.height)}};function Vt(t,s){return new Ye(t,s)}function Ve(t,s){const r=Number.isFinite(t)?t:1;return Math.max(1,Math.min(s,r))}function Be(){return{top:0,right:0,bottom:0,left:0}}function Fe(){const t=getComputedStyle(document.documentElement),s=le(t.getPropertyValue("--safe-area-inset-top")),r=le(t.getPropertyValue("--safe-area-inset-right")),a=le(t.getPropertyValue("--safe-area-inset-bottom")),i=le(t.getPropertyValue("--safe-area-inset-left"));return{top:s,right:r,bottom:a,left:i}}function le(t){const s=parseFloat(String(t).trim().replace("px",""));return Number.isFinite(s)?s:0}function $e(t){const{container:s,design:r,safeArea:a}=t,i=Math.max(1,s.width-a.left-a.right),c=Math.max(1,s.height-a.top-a.bottom),f=Math.min(i/r.width,c/r.height),y=Math.round(r.width*f),h=Math.round(r.height*f),m=Math.round(a.left+(i-y)/2),S=Math.round(a.top+(c-h)/2);return{container:s,safeArea:a,design:r,scale:f,viewport:{x:m,y:S,width:y,height:h}}}function Bt(t,s){return t.container.width===s.container.width&&t.container.height===s.container.height&&t.safeArea.top===s.safeArea.top&&t.safeArea.right===s.safeArea.right&&t.safeArea.bottom===s.safeArea.bottom&&t.safeArea.left===s.safeArea.left&&Math.abs(t.scale-s.scale)<1e-6&&t.viewport.x===s.viewport.x&&t.viewport.y===s.viewport.y&&t.viewport.width===s.viewport.width&&t.viewport.height===s.viewport.height}var Ft=class{constructor(t,s){x(this,"scene"),x(this,"opts"),this.scene=t,this.opts={preferNetworkProbe:s?.preferNetworkProbe??!0,probeTimeoutMs:s?.probeTimeoutMs??1500,debug:s?.debug??!1,strict:s?.strict??!1,onProgress:s?.onProgress}}async loadPack(t){const s=t.images??[],r=t.atlases??[],a=t.audio??[],i=t.json??[],c=await Promise.all(s.map(e=>this.resolveImage(e))),f=await Promise.all(r.map(e=>this.resolveAtlas(e))),y=this.scene.load;for(const e of c)this.scene.textures.exists(e.key)||(y.image(e.key,e.url),e.crossOrigin!=null&&y.setCORS(e.crossOrigin));for(const e of f)this.scene.textures.exists(e.key)||(y.atlas(e.key,e.imageUrl,e.atlasJsonPath),e.crossOrigin!=null&&y.setCORS(e.crossOrigin));for(const e of a)this.scene.cache.audio.exists(e.key)||y.audio(e.key,e.paths);for(const e of i)this.scene.cache.json.exists(e.key)||y.json(e.key,e.path);const h=c.length+f.length+a.length;if(h===0)return;let m=0;const S=(e,n)=>{const o=n??(h?m/h:1);this.opts.onProgress?.({loaded:m,total:h,progress01:$t(o),currentKey:e})};y.on(H.Loader.Events.FILE_COMPLETE,e=>{m+=1,S(e)}),await new Promise((e,n)=>{let o=null;const u=p=>{o??(o=p)};y.once(H.Loader.Events.FILE_LOAD_ERROR,u),y.once(H.Loader.Events.COMPLETE,async(p,_,d)=>{try{if(d>0){const v=o;n(new Error(`ASSET_LOAD_FAIL: failed=${d}, complete=${_}, first=${v?.key||"unknown"} url=${v?.src||v?.url||""}`));return}await this.decodeTextures([...c.map(v=>v.key),...f.map(v=>v.key)]),S(void 0,1),e()}catch(v){n(v)}}),S(void 0,0),y.start()}),y.off(H.Loader.Events.FILE_LOAD_ERROR),y.off(H.Loader.Events.FILE_COMPLETE)}async resolveImage(t){const s=t.exts??["avif","webp","png","jpg","jpeg"],r=await this.pickBest(`${t.basePath}`,s);return{key:t.key,url:r,crossOrigin:t.crossOrigin}}async resolveAtlas(t){const s=t.exts??["avif","webp","png"],r=await this.pickBest(`${t.imageBasePath}`,s);return{key:t.key,imageUrl:r,atlasJsonPath:t.atlasJsonPath,crossOrigin:t.crossOrigin}}async pickBest(t,s){const r=Ht(s),a=[];if(this.opts.preferNetworkProbe){for(const i of r){const c=`${t}.${i}`;if(a.push(c),await Ut(c,this.opts.probeTimeoutMs))return c}if(this.opts.strict)throw new Error(`ASSET_MISSING: ${t} (tried: ${a.join(", ")})`);return`${t}.${r[0]}`}return`${t}.${r[0]}`}async decodeTextures(t){const s=Array.from(new Set(t)),r=[];for(const a of s){const i=this.scene.textures.get(a);if(!i)continue;const c=i.source??[];for(const f of c){const y=f?.image;y&&(y.__irukaDecoded||r.push(jt(y).then(()=>{y.__irukaDecoded=!0})))}}await Promise.all(r)}};function $t(t){return Math.max(0,Math.min(1,t))}function Ht(t){const s=Gt(),r=Nt(),a=i=>{const c=i.toLowerCase();return c==="avif"?s?0:100:c==="webp"?r?1:101:c==="png"?10:c==="jpg"||c==="jpeg"?11:50};return[...t].sort((i,c)=>a(i)-a(c))}function Nt(){try{return document.createElement("canvas").toDataURL("image/webp").startsWith("data:image/webp")}catch{return!1}}function Gt(){try{return!!(typeof CSS<"u"&&CSS.supports?.("image-rendering","auto"))}catch{return!1}}async function Ut(t,s){const r=new AbortController,a=setTimeout(()=>r.abort(),s);try{return(await fetch(t,{method:"HEAD",mode:"cors",cache:"no-cache",signal:r.signal})).ok}catch{return!1}finally{clearTimeout(a)}}async function jt(t){if(typeof t.decode=="function"){try{await t.decode()}catch{}return}}var qt=class{constructor(t){x(this,"tracks",new Map),x(this,"unlocked",!1),x(this,"muted",!1),x(this,"bgmKey",null),x(this,"voiceKey",null),x(this,"pendingPlays",[]),x(this,"queueUntilUnlock",!0),x(this,"opts"),this.opts={groupVolume:{bgm:t?.groupVolume?.bgm??1,voice:t?.groupVolume?.voice??1,sfx:t?.groupVolume?.sfx??1},duckBgmTo:t?.duckBgmTo??.25,fadeMs:t?.fadeMs??200,debug:t?.debug??!1,onState:t?.onState,defaultProbe:t?.defaultProbe??!0,defaultProbeTimeoutMs:t?.defaultProbeTimeoutMs??1200}}async register(t){for(const s of t){if(this.tracks.has(s.key))continue;const r=await this.resolveSrc(s);if(!r.length){this.d("[audio] no valid src resolved for",s.key);continue}s.crossOrigin&&(se.Howler.autoUnlock=!0);const i=new se.Howl({src:r,preload:s.preload??!0,loop:s.loop??!1,volume:this.computeTrackVolume(s),rate:s.rate??1,html5:s.kind==="bgm"});this.tracks.set(s.key,{asset:s,howl:i})}}has(t){return this.tracks.has(t)}async loadAll(t){const s=t?.strict??!1,r=[...this.tracks.entries()],a=r.length;let i=0;const f=(await Promise.all(r.map(([y,h])=>new Promise(m=>{const S=(e,n)=>{i+=1,t?.onProgress?.({loaded:i,total:a}),m({key:y,ok:e,err:n})};if(h.howl.state()==="loaded")return S(!0);h.howl.once("load",()=>S(!0)),h.howl.once("loaderror",(e,n)=>S(!1,n));try{h.howl.load()}catch(e){S(!1,e)}})))).filter(y=>!y.ok);if(s&&f.length)throw new Error(`AUDIO_LOAD_FAIL: ${f.map(y=>y.key).join(", ")}`)}async unlock(){if(this.unlocked)return!0;try{const t=se.Howler.ctx;t&&t.state==="suspended"&&await t.resume();const s=new se.Howl({src:["data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA"],volume:0});s.play(),s.stop(),this.unlocked=!0,this.emitState(),this.d("[audio] unlocked");const r=[...this.pendingPlays];return this.pendingPlays=[],r.forEach(a=>{try{a()}catch{}}),!0}catch(t){return this.d("[audio] unlock failed",t),!1}}bindUnlockToGesture(t=document){const s=async()=>{await this.unlock(),t.removeEventListener("pointerdown",s),t.removeEventListener("touchstart",s),t.removeEventListener("click",s)};t.addEventListener("pointerdown",s,{passive:!0,once:!0}),t.addEventListener("touchstart",s,{passive:!0,once:!0}),t.addEventListener("click",s,{passive:!0,once:!0})}setMuted(t){this.muted=t,se.Howler.mute(t),this.emitState()}isUnlocked(){return this.unlocked}playSfx(t){return this.play(t,"sfx")}playVoice(t){return this.play(t,"voice")}async setBgm(t){if(this.bgmKey===t){const a=this.tracks.get(t);a&&!a.howl.playing()&&a.howl.play();return}const s=this.bgmKey;this.bgmKey=t,s&&this.fadeOutStop(s);const r=this.tracks.get(t);r&&(r.howl.volume(0),r.howl.loop(!0),r.howl.play(),this.fadeTo(t,this.computeTrackVolume(r.asset),this.opts.fadeMs))}stopBgm(){this.bgmKey&&(this.fadeOutStop(this.bgmKey),this.bgmKey=null)}stopAllVoices(){for(const[t,s]of this.tracks.entries())if(s.asset.kind==="voice")try{s.howl.stop()}catch{}this.voiceKey&&(this.voiceKey=null),this.duckBgm(!1)}stopAll(){for(const[t]of this.tracks)this.stop(t);this.bgmKey=null,this.voiceKey=null}pauseAll(){for(const t of this.tracks.values())t.howl.playing()&&t.howl.pause()}resumeAll(){if(this.bgmKey){const t=this.tracks.get(this.bgmKey);t&&!t.howl.playing()&&t.howl.play()}if(this.voiceKey){const t=this.tracks.get(this.voiceKey);t&&!t.howl.playing()&&t.howl.play()}}async resolveSrc(t){if(t.src?.length)return t.src;if(!t.basePath)return[];const r=(t.exts??["m4a","mp3","ogg"]).map(f=>`${t.basePath}.${f}`);if(!(t.probe??this.opts.defaultProbe))return r;const i=t.probeTimeoutMs??this.opts.defaultProbeTimeoutMs;return await Wt(r,i)}play(t,s){const r=this.tracks.get(t);if(!r)return this.d("[audio] missing:",t),null;const a=()=>{s==="voice"&&(this.voiceKey&&this.voiceKey!==t&&this.stop(this.voiceKey),this.voiceKey=t,this.duckBgm(!0)),r.howl.volume(this.computeTrackVolume(r.asset));const i=r.howl.play();return r.howl.once("end",()=>{s==="voice"&&this.voiceKey===t&&(this.voiceKey=null,this.duckBgm(!1))},i),r.howl.once("stop",()=>{s==="voice"&&this.voiceKey===t&&(this.voiceKey=null,this.duckBgm(!1))},i),i};return!this.unlocked&&this.queueUntilUnlock?(this.pendingPlays.push(a),this.d("[audio] queue play until unlock:",t),null):a()}stop(t){const s=this.tracks.get(t);if(s)try{s.howl.stop()}catch{}}fadeOutStop(t){const s=this.tracks.get(t);if(s)try{const r=s.howl.volume();s.howl.fade(r,0,this.opts.fadeMs),window.setTimeout(()=>{try{s.howl.stop()}catch{}s.howl.volume(this.computeTrackVolume(s.asset))},this.opts.fadeMs+30)}catch{this.stop(t)}}fadeTo(t,s,r){const a=this.tracks.get(t);if(a)try{const i=a.howl.volume();a.howl.fade(i,s,r)}catch{a.howl.volume(s)}}duckBgm(t){if(!this.bgmKey)return;const s=this.tracks.get(this.bgmKey);if(!s)return;const r=this.computeTrackVolume(s.asset),a=t?Math.min(r,this.opts.duckBgmTo):r;this.fadeTo(this.bgmKey,a,this.opts.fadeMs)}computeTrackVolume(t){const s=t.volume??1,r=this.opts.groupVolume[t.kind]??1;return Kt(s*r)}emitState(){this.opts.onState?.({unlocked:this.unlocked,muted:this.muted})}d(...t){this.opts.debug&&console.log(...t)}};function Kt(t){return Math.max(0,Math.min(1,t))}async function Wt(t,s){const r=[];for(const a of t)await Qt(a,s)&&r.push(a);return r.length?r:t}async function Qt(t,s){const r=new AbortController,a=setTimeout(()=>r.abort(),s);try{return(await fetch(t,{method:"HEAD",cache:"no-cache",signal:r.signal})).ok}catch{return!1}finally{clearTimeout(a)}}function Xt(t){const s=t.sceneKey??"EndGameScene",r=t.designBase??{w:1280,h:720},a=t.confetti?.colors??[16739179,5164484,16770669,9822675,15958401,11179738];return class extends H.Scene{constructor(){super(s),x(this,"confettiEvent"),x(this,"dimBg"),x(this,"banner"),x(this,"icon"),x(this,"replayBtn"),x(this,"exitBtn"),x(this,"dataIn")}init(c){this.dataIn=c}preload(){const{assets:c}=t,f=(y,h)=>{h&&(this.textures.exists(y)||this.load.image(y,h))};f(c.banner.key,c.banner.url),c.icon&&f(c.icon.key,c.icon.url),f(c.replayBtn.key,c.replayBtn.url),f(c.exitBtn.key,c.exitBtn.url)}create(){t.onEnter?.(),t.audio&&t.sounds?.enter&&t.audio.play(t.sounds.enter),this.time.delayedCall(2e3,()=>{t.audio&&(t.sounds?.fireworks&&t.audio.play(t.sounds.fireworks),t.sounds?.applause&&t.audio.play(t.sounds.applause))}),this.buildUI(),this.layout(),this.scale.on("resize",()=>this.layout()),t.confetti?.enabled!==!1&&this.startConfetti()}buildUI(){const c=this.scale.width,f=this.scale.height;this.banner=this.add.image(c/2,f/2-f*.12,t.assets.banner.key).setOrigin(.5).setDepth(100),t.assets.icon&&this.textures.exists(t.assets.icon.key)&&(this.icon=this.add.image(c/2,f/2-150,t.assets.icon.key).setDepth(110),this.icon.setScale(.5),this.tweens.add({targets:this.icon,y:this.icon.y-10,duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.tweens.add({targets:this.icon,angle:{from:-5,to:5},duration:600,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}));const h=250*(Math.min(c,f)/1280);this.replayBtn=this.add.image(c/2-h,f/2+f*.2,t.assets.replayBtn.key).setOrigin(.5).setDepth(120).setInteractive({useHandCursor:!0}),this.exitBtn=this.add.image(c/2+h,f/2+f*.2,t.assets.exitBtn.key).setOrigin(.5).setDepth(120).setInteractive({useHandCursor:!0}),this.replayBtn.on("pointerdown",()=>this.onReplay()),this.exitBtn.on("pointerdown",()=>this.onExit()),[this.replayBtn,this.exitBtn].forEach(m=>{m.on("pointerover",()=>m.setScale(m.scale*1.1)),m.on("pointerout",()=>this.layout())})}layout(){const c=this.scale.width,f=this.scale.height;this.dimBg&&this.dimBg.setSize(c,f);const y=Math.min(c/r.w,f/r.h);this.banner&&(this.banner.setPosition(c/2,f/2-f*.12),this.banner.setDisplaySize(c*.9,f*.9)),this.icon&&(this.icon.setPosition(c/2,f/2-150*y),this.icon.setScale(.5*y));const h=Math.min(c,f)/1280,m=250*h;this.replayBtn&&(this.replayBtn.setPosition(c/2-m,f/2+f*.2),this.replayBtn.setScale(h)),this.exitBtn&&(this.exitBtn.setPosition(c/2+m,f/2+f*.2),this.exitBtn.setScale(h))}onReplay(){t.audio&&t.sounds?.click&&t.audio.play(t.sounds.click),t.audio?.stopAll?.(),Ke(),this.stopConfetti(),t.replaySceneKey?(t.onLeave?.(),this.scene.stop(s),this.scene.start(t.replaySceneKey)):this.scene.restart()}onExit(){t.audio&&t.sounds?.click&&t.audio.play(t.sounds.click),t.audio?.stopAll?.(),this.stopConfetti();const c=this.dataIn?.startTime??Date.now(),f=Math.max(0,Date.now()-c),y=Qe(),h={score:y.finalScore??this.dataIn?.score??0,timeMs:f,extras:{...this.dataIn?.extras??{},reason:"user_exit",stats:y}};if(t.reportComplete){t.reportComplete(h);return}t.fallbackSceneKey&&(t.onLeave?.(),this.scene.stop(s),this.scene.start(t.fallbackSceneKey))}startConfetti(){const c=t.confetti?.rateMs??100;this.confettiEvent=this.time.addEvent({delay:c,loop:!0,callback:()=>{if(!this.scene.isActive())return;const f=this.cameras.main.width;for(let y=0;y<3;y++)this.createConfettiPiece(H.Math.Between(0,f),-20,H.Utils.Array.GetRandom(a),H.Utils.Array.GetRandom(["circle","rect"]))}})}createConfettiPiece(c,f,y,h){let m;h==="circle"?m=this.add.circle(c,f,H.Math.Between(4,8),y,1):m=this.add.rectangle(c,f,H.Math.Between(6,12),H.Math.Between(10,20),y,1),m.setDepth(999),m.setRotation(H.Math.Between(0,360)*Math.PI/180);const S=H.Math.Between(3e3,5e3),e=this.cameras.main.height+50,n=H.Math.Between(-100,100);this.tweens.add({targets:m,y:e,x:c+n,rotation:m.rotation+H.Math.Between(2,4)*Math.PI,duration:S,ease:"Linear",onComplete:()=>m.destroy()}),this.tweens.add({targets:m,alpha:{from:1,to:.3},duration:S,ease:"Cubic.easeIn"})}stopConfetti(){this.confettiEvent&&(this.confettiEvent.remove(!1),this.confettiEvent=void 0)}}}var Jt={};he(Jt,{EndSession:()=>on,ExerciseType:()=>Ze,StartSession:()=>nn,Submit:()=>rn,VoiceApiError:()=>fe,VoiceSessionClient:()=>Ie,configureVoiceSessionClient:()=>en,getVoiceSessionClient:()=>tn});var Ze=(t=>(t.NURSERY_RHYME="NURSERY_RHYME",t.COUNTING="COUNTING",t.SPELLING="SPELLING",t))(Ze||{}),Yt="https://iruka-api-1037337851453.asia-southeast1.run.app",Zt="v1",fe=class extends Error{constructor(t){super(t.message),x(this,"status"),x(this,"endpoint"),x(this,"detail"),this.name="VoiceApiError",this.status=t.status,this.endpoint=t.endpoint,this.detail=t.detail}};function be(t){const s=new AbortController,r=setTimeout(()=>s.abort(),t);return{signal:s.signal,cancel:()=>clearTimeout(r)}}async function Se(t){return t?typeof t=="function"?await t():t:{}}async function Ae(t){const s=t.headers.get("content-type")||"";try{if(s.includes("application/json")){const a=await t.json();return{detail:typeof a.detail=="string"?a.detail:JSON.stringify(a)}}return{rawText:await t.text()}}catch{return{}}}function zt(t,s){const r=mt();return{gameSessionId:t.gameSessionId??r.sessionId??s?.gameSessionId,gameId:t.gameId??r.gameId??s?.gameId,lessonId:t.lessonId??r.lessonId??s?.lessonId,gameVersion:t.gameVersion??r.gameVersion??s?.gameVersion}}var Ie=class{constructor(t={}){x(this,"baseUrl"),x(this,"apiVersion"),x(this,"timeoutMs"),x(this,"defaultTestMode"),x(this,"headers"),x(this,"defaultMeta"),x(this,"lastVoiceSessionId",null),this.baseUrl=t.baseUrl||Yt,this.apiVersion=t.apiVersion||Zt,this.timeoutMs=t.timeoutMs??6e4,this.defaultTestMode=t.testMode??!1,this.headers=t.headers,this.defaultMeta=t.defaultMeta}setLastVoiceSessionId(t){this.lastVoiceSessionId=t}getLastVoiceSessionId(){return this.lastVoiceSessionId}async startSession(t={}){const s=t.testmode??this.defaultTestMode,r=`/api/${this.apiVersion}/voice-sessions/start?testmode=${s}`,a=`${this.baseUrl}${r}`,i=zt(t,this.defaultMeta);if(!i.gameId||!i.gameVersion)if(s)i.gameId??(i.gameId="local-game"),i.gameVersion??(i.gameVersion="0.0.0");else throw new Error("Voice startSession missing meta (gameId/gameVersion). Call configureSdkContext({ fallback: ... }) or run inside Hub INIT.");const c=await Se(this.headers),{signal:f,cancel:y}=be(this.timeoutMs);try{const h=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...c},body:JSON.stringify({gameSessionId:i.gameSessionId,gameId:i.gameId,lessonId:i.lessonId,gameVersion:i.gameVersion}),signal:f});if(!h.ok){const S=await Ae(h);throw new fe({status:h.status,endpoint:r,detail:S.detail,message:`Start session failed (${h.status})${S.detail?`: ${S.detail}`:""}`})}const m=await h.json();return this.lastVoiceSessionId=m.sessionId,m}finally{y()}}resolveVoiceSessionId(t){const s=t??this.lastVoiceSessionId;if(!s)throw new Error("Missing voice sessionId. Call StartSession() first (or pass sessionId explicitly).");return s}async submitAnswer(t){const s=this.resolveVoiceSessionId(t.sessionId),r=t.testmode??this.defaultTestMode,a=`/api/${this.apiVersion}/voice-sessions/${s}/submit?testmode=${r}`,i=`${this.baseUrl}${a}`,c=await Se(this.headers),{signal:f,cancel:y}=be(this.timeoutMs);try{const h=new FormData,m=typeof t.audioFile?.name=="string"?t.audioFile.name:"audio.wav";h.append("audio_file",t.audioFile,m),h.append("questionIndex",String(t.questionIndex)),h.append("targetText",typeof t.targetText=="string"?t.targetText:JSON.stringify(t.targetText)),h.append("durationMs",String(t.durationMs)),h.append("exercise_type",t.exerciseType);const S=await fetch(i,{method:"POST",headers:{...c},body:h,signal:f});if(!S.ok){const e=await Ae(S);throw new fe({status:S.status,endpoint:a,detail:e.detail,message:`Submit answer failed (${S.status})${e.detail?`: ${e.detail}`:""}`})}return await S.json()}finally{y()}}async endSession(t){const s=this.resolveVoiceSessionId(t.sessionId),r=t.testmode??this.defaultTestMode,a=`/api/${this.apiVersion}/voice-sessions/${s}/end?testmode=${r}`,i=`${this.baseUrl}${a}`,c=await Se(this.headers),{signal:f,cancel:y}=be(this.timeoutMs);try{const h=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...c},body:JSON.stringify({sessionId:s,totalQuestionsExpect:t.totalQuestionsExpect,isUserAborted:t.isUserAborted}),signal:f});if(!h.ok){const S=await Ae(h);throw new fe({status:h.status,endpoint:a,detail:S.detail,message:`End session failed (${h.status})${S.detail?`: ${S.detail}`:""}`})}const m=await h.json();return this.lastVoiceSessionId=null,m}finally{y()}}},ue=new Ie;function en(t){ue=new Ie(t)}function tn(){return ue}async function nn(t={}){return ue.startSession(t)}async function rn(t){return ue.submitAnswer(t)}async function on(t){return ue.endSession(t)}export{an as _,ot as g,se as h};
